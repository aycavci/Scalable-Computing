\c imdb

create table dataset(
  nconst varchar,
  birthyear int,
  title_count int,
  votes_avg float,
  rating_avg float,
  is_adult float,
  release_year_min int,
  release_year_max int,
  release_year_avg float,
  title_type_movie float,
  title_type_short float,
  title_type_tv_episode float,
  title_type_tv_mini_series float,
  title_type_tv_movie float,
  title_type_tv_series float,
  title_type_tv_short float,
  title_type_tv_special float,
  title_type_video float,
  title_type_video_game float,
  role_category_actor float,
  role_category_archive_footage float,
  role_category_archive_sound float,
  role_category_cinematographer float,
  role_category_composer float,
  role_category_director float,
  role_category_editor float,
  role_category_producer float,
  role_category_production_designer float,
  role_category_self float,
  role_category_writer float,
  genre_action float,
  genre_adult float,
  genre_adventure float,
  genre_animation float,
  genre_biography float,
  genre_comedy float,
  genre_crime float,
  genre_documentary float,
  genre_drama float,
  genre_family float,
  genre_fantasy float,
  genre_film_noir float,
  genre_game_show float,
  genre_history float,
  genre_horror float,
  genre_music float,
  genre_musical float,
  genre_mystery float,
  genre_news float,
  genre_reality_tv float,
  genre_romance float,
  genre_sci_fi float,
  genre_short float,
  genre_sport float,
  genre_talk_show float,
  genre_thriller float,
  genre_war float,
  genre_western float
);


create table temp_dataset(
  nconst varchar,
  birthyear varchar,
  title_count varchar,
  votes_avg varchar,
  rating_avg varchar,
  is_adult varchar,
  release_year_min varchar,
  release_year_max varchar,
  release_year_avg varchar,
  title_type_movie varchar,
  title_type_short varchar,
  title_type_tv_episode varchar,
  title_type_tv_mini_series varchar,
  title_type_tv_movie varchar,
  title_type_tv_series varchar,
  title_type_tv_short varchar,
  title_type_tv_special varchar,
  title_type_video varchar,
  title_type_video_game varchar,
  role_category_actor varchar,
  role_category_archive_footage varchar,
  role_category_archive_sound varchar,
  role_category_cinematographer varchar,
  role_category_composer varchar,
  role_category_director varchar,
  role_category_editor varchar,
  role_category_producer varchar,
  role_category_production_designer varchar,
  role_category_self varchar,
  role_category_writer varchar,
  genre_action varchar,
  genre_adult varchar,
  genre_adventure varchar,
  genre_animation varchar,
  genre_biography varchar,
  genre_comedy varchar,
  genre_crime varchar,
  genre_documentary varchar,
  genre_drama varchar,
  genre_family varchar,
  genre_fantasy varchar,
  genre_film_noir varchar,
  genre_game_show varchar,
  genre_history varchar,
  genre_horror varchar,
  genre_music varchar,
  genre_musical varchar,
  genre_mystery varchar,
  genre_news varchar,
  genre_reality_tv varchar,
  genre_romance varchar,
  genre_sci_fi varchar,
  genre_short varchar,
  genre_sport varchar,
  genre_talk_show varchar,
  genre_thriller varchar,
  genre_war varchar,
  genre_western varchar
);

\copy temp_dataset from dataset/dataset.tsv DELIMITER E'\t';


insert into dataset(
	nconst,
  birthyear,
  title_count,
  votes_avg,
  rating_avg,
  is_adult,
  release_year_min,
  release_year_max,
  release_year_avg,
  title_type_movie,
  title_type_short,
  title_type_tv_episode,
  title_type_tv_mini_series,
  title_type_tv_movie,
  title_type_tv_series,
  title_type_tv_short,
  title_type_tv_special,
  title_type_video,
  title_type_video_game,
  role_category_actor,
  role_category_archive_footage,
  role_category_archive_sound,
  role_category_cinematographer,
  role_category_composer,
  role_category_director,
  role_category_editor,
  role_category_producer,
  role_category_production_designer,
  role_category_self,
  role_category_writer,
  genre_action,
  genre_adult,
  genre_adventure,
  genre_animation,
  genre_biography,
  genre_comedy,
  genre_crime,
  genre_documentary,
  genre_drama,
  genre_family,
  genre_fantasy,
  genre_film_noir,
  genre_game_show,
  genre_history,
  genre_horror,
  genre_music,
  genre_musical,
  genre_mystery,
  genre_news,
  genre_reality_tv,
  genre_romance,
  genre_sci_fi,
  genre_short,
  genre_sport,
  genre_talk_show,
  genre_thriller,
  genre_war,
  genre_western
)
select
  temp_dataset.nconst,
  NULLIF(temp_dataset.birthyear, '')::int,
  NULLIF(temp_dataset.title_count, '')::int,
  NULLIF(temp_dataset.votes_avg, '')::float,
  NULLIF(temp_dataset.rating_avg, '')::float,
  NULLIF(temp_dataset.is_adult, '')::float,
  NULLIF(temp_dataset.release_year_min, '')::int,
  NULLIF(temp_dataset.release_year_max, '')::int,
  NULLIF(temp_dataset.release_year_avg, '')::float,
  NULLIF(temp_dataset.title_type_movie, '')::float,
  NULLIF(temp_dataset.title_type_short, '')::float,
  NULLIF(temp_dataset.title_type_tv_episode, '')::float,
  NULLIF(temp_dataset.title_type_tv_mini_series, '')::float,
  NULLIF(temp_dataset.title_type_tv_movie, '')::float,
  NULLIF(temp_dataset.title_type_tv_series, '')::float,
  NULLIF(temp_dataset.title_type_tv_short, '')::float,
  NULLIF(temp_dataset.title_type_tv_special, '')::float,
  NULLIF(temp_dataset.title_type_video, '')::float,
  NULLIF(temp_dataset.title_type_video_game, '')::float,
  NULLIF(temp_dataset.role_category_actor, '')::float,
  NULLIF(temp_dataset.role_category_archive_footage, '')::float,
  NULLIF(temp_dataset.role_category_archive_sound, '')::float,
  NULLIF(temp_dataset.role_category_cinematographer, '')::float,
  NULLIF(temp_dataset.role_category_composer, '')::float,
  NULLIF(temp_dataset.role_category_director, '')::float,
  NULLIF(temp_dataset.role_category_editor, '')::float,
  NULLIF(temp_dataset.role_category_producer, '')::float,
  NULLIF(temp_dataset.role_category_production_designer, '')::float,
  NULLIF(temp_dataset.role_category_self, '')::float,
  NULLIF(temp_dataset.role_category_writer, '')::float,
  NULLIF(temp_dataset.genre_action, '')::float,
  NULLIF(temp_dataset.genre_adult, '')::float,
  NULLIF(temp_dataset.genre_adventure, '')::float,
  NULLIF(temp_dataset.genre_animation, '')::float,
  NULLIF(temp_dataset.genre_biography, '')::float,
  NULLIF(temp_dataset.genre_comedy, '')::float,
  NULLIF(temp_dataset.genre_crime, '')::float,
  NULLIF(temp_dataset.genre_documentary, '')::float,
  NULLIF(temp_dataset.genre_drama, '')::float,
  NULLIF(temp_dataset.genre_family, '')::float,
  NULLIF(temp_dataset.genre_fantasy, '')::float,
  NULLIF(temp_dataset.genre_film_noir, '')::float,
  NULLIF(temp_dataset.genre_game_show, '')::float,
  NULLIF(temp_dataset.genre_history, '')::float,
  NULLIF(temp_dataset.genre_horror, '')::float,
  NULLIF(temp_dataset.genre_music, '')::float,
  NULLIF(temp_dataset.genre_musical, '')::float,
  NULLIF(temp_dataset.genre_mystery, '')::float,
  NULLIF(temp_dataset.genre_news, '')::float,
  NULLIF(temp_dataset.genre_reality_tv, '')::float,
  NULLIF(temp_dataset.genre_romance, '')::float,
  NULLIF(temp_dataset.genre_sci_fi, '')::float,
  NULLIF(temp_dataset.genre_short, '')::float,
  NULLIF(temp_dataset.genre_sport, '')::float,
  NULLIF(temp_dataset.genre_talk_show, '')::float,
  NULLIF(temp_dataset.genre_thriller, '')::float,
  NULLIF(temp_dataset.genre_war, '')::float,
  NULLIF(temp_dataset.genre_western, '')::float
from
	temp_dataset;


drop table temp_dataset;
